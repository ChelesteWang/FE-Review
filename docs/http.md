## 计算机网络

### dns 查询流程
- 浏览器缓存：浏览器会按照一定的频率缓存 DNS 记录。
- 操作系统缓存：如果浏览器缓存中找不到需要的 DNS 记录，那就去操作系统中找。
- 路由缓存：路由器也有 DNS 缓存。
- ISP 的 DNS 服务器：ISP 是互联网服务提供商(Internet Service Provider)的简称，ISP 有专门的DNS 服务器应对 DNS 查询请求。
- 根服务器：ISP 的 DNS 服务器还找不到的话，它就会向根服务器发出请求，进行递归查询（DNS 服务器先问根域名服务器.com 域名服务器的 IP 地址，然后再问.baidu 域名服务器，依次类推
当用户在浏览器中输入一个网址，就会触发 DNS 查询。这个时候在上述的 3 个层级中，还会增加本地 DNS 服务器层级。本地 DNS 服务器包括用户自己路由器中的 DNS 缓存、小区的 DNS 服务器、ISP 的 DNS 服务器等。

dns 服务器存储域名对应IP信息，分层分级缓存

### http 特点

- 特点：无连接、无状态、灵活、简单快速
- 无状态、不安全、明文传输、队头阻塞

因此需要 HTTPS 补充密文传输以及安全问题

队头阻塞问题：只建立一个TCP连接，同一时刻只能处理一个请求

### option 作用

- 获取服务端支持的所有 request methods
- 在复杂请求时进行预检

### get post 区别

- get 参数 url post 大多数使用 request body 
- get 请求幂等

### put post 区别

语义上 post 用于新增数据 ，put 用于修改数据，因此 put 具备幂等性

### http 状态码

- 301	Moved Permanently 永久重定向（网站更换域名） 
- 302	Found 临时重定向（中间跳转页）

- 304	Not Modified 未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。可以使用缓存的资源，不用在服务器获取。当协商缓存命中时会返回这个状态码。

### HTTP keep-alive 
持久连接的好处在于减少了 TCP 连接的重复建立和断开所造成的额外开销，减轻了服务器端的负载。另外， 减少开销的那部分时间，使 HTTP 请求和响应能够更早地结束，这样 Web 页面的显示速度也就相应提高了。
HTTP1.1规定了默认保持长连接，数据传输完成了保持TCP连接不断开，等待在同域名下继续用这个通道传输数据。如果需要关闭，需要客户端发送Connection：close首部字段。HTTP1.0版本是默认没有Keep-alive的（也就是默认会发送keep-alive），所以要想连接得到保持，必须手动配置发送Connection: keep-alive字段。若想断开keep-alive连接，需发送Connection:close字段；

### HTTP 1.0 和 HTTP 1.1 之间有哪些区别

1. http1.1 默认使用持久连接
2. 支持断点续传
3. 新增了很多请求方法，
4. 新增 host 字段

### 页面有多张图片，HTTP是怎样的加载表现？

http1 创建多个 TCP 链接，每个域最多创建 6 个因此需要使用不同域加载资源

http2 支持使用多路复用，可以在一个TCP连接中发送多个HTTP请求

总结：
**长连接**：http1.1 默认开启长连接，每个域最多创建 6 个 TCP ，创建 tcp 连接的时候需要经历三次握手，较消耗时间，http1.0 需要请求时加上 Connection: keep-a live 来要求服务器不要关闭 TCP 连接。 

**管道网络传输**：可以在同一个 TCP 连接里面，客户端可以发起多个请求，只要第一个请求发出去了，不必等其回来，就可以发第二个请求出去，可以减少整体的响应时间。但是服务器还是按照顺序回应请求。如果前面的回应特别慢，后面就会有许多请求排队等着。这称为队头堵塞。

**队头堵塞**：

HTTP 传输的报文必须是一发一收，但是，里面的任务被放在一个任务队列中**串行**执行，一旦队首的请求处理太慢，就会阻塞后面请求的处理。这就是HTTP队头阻塞问题。

队头阻塞的解决方案

（1）并发连接：对于一个域名允许分配多个长连接，那么相当于增加了任务队列，不至于一个队伍的任务阻塞其它所有任务。

（2）域名分片：将域名分出很多二级域名，它们都指向同样的一台服务器，能够并发的长连接数变多，解决了队头阻塞的问题。

### https 

https = http + tls/ssl（传输层安全性协议(TLS) 或安全套接字协议(SSL)）散列函数、对称加密和非对称加密

HTTPS = HTTP+加密+认证+完整性保护

在交换密钥环节使用非对称加密方式，之后的建立通信交换报文阶段则使用对称加密方式。

HTTPS 主要分为两个阶段证书验证和数据传输阶段

1. 服务器向CA备案，CA发放证书,其中签名散列函数计算公开的明文信息的信息摘要，然后，采用 CA的私钥对信息摘要进行加密，密文即签名;
2. 客户端向服务器发出请求，Server 返回证书文件
3. 证书验证:客户端读取证书，采用相同的散列函数计算得到信息摘要，然后，利用对应 CA的公钥解密签名数据，对比证书的信息摘要，如果一致，则可以确认证书的合法性，即服务器的公开密钥是值得信赖的。
4. 客户端使用服务器公钥加密对称密钥发给服务端。
5. 服务端使用私钥解密得到对称密钥。至此客户端服务端都有了对称私钥
6. 数据传输：客户与服务端均使用对称加密秘钥对信息进行加密

总结：
https 使用非对称加密防止用于传输的对称秘钥被捕获，使用信息摘要算法保证证书没有篡改

### http 1.1 & 2.0 & 3,0

- http1.1 默认开启长连接，新的缓存头部（Entity tag，If-Unmodified-Since, If-Match, If-None-Match），range 读取断点续传，支持 host 域信息（物理主机中的虚拟主机的域名）
- http2.0 二进制传输，复用 TCP 链接多路复用，头部压缩，服务推送
- http3.0 QUIC 协议基于 UDP 
